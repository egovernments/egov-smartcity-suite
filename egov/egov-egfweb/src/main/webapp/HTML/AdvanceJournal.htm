#-------------------------------------------------------------------------------
# eGov suite of products aim to improve the internal efficiency,transparency, 
#      accountability and the service delivery of the government  organizations.
#   
#       Copyright (C) <2015>  eGovernments Foundation
#   
#       The updated version of eGov suite of products as by eGovernments Foundation 
#       is available at http://www.egovernments.org
#   
#       This program is free software: you can redistribute it and/or modify
#       it under the terms of the GNU General Public License as published by
#       the Free Software Foundation, either version 3 of the License, or
#       any later version.
#   
#       This program is distributed in the hope that it will be useful,
#       but WITHOUT ANY WARRANTY; without even the implied warranty of
#       MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#       GNU General Public License for more details.
#   
#       You should have received a copy of the GNU General Public License
#       along with this program. If not, see http://www.gnu.org/licenses/ or 
#       http://www.gnu.org/licenses/gpl.html .
#   
#       In addition to the terms of the GPL license to be adhered to in using this
#       program, the following additional terms are to be complied with:
#   
#   	1) All versions of this program, verbatim or modified must carry this 
#   	   Legal Notice.
#   
#   	2) Any misrepresentation of the origin of the material is prohibited. It 
#   	   is required that all modified versions of this material be marked in 
#   	   reasonable ways as different from the original version.
#   
#   	3) This license does not grant any rights to any user of the program 
#   	   with regards to rights under trademark law for use of the trade names 
#   	   or trademarks of eGovernments Foundation.
#   
#     In case of any queries, you can reach eGovernments Foundation at contact@egovernments.org.
#-------------------------------------------------------------------------------
<html>
	<style type="text/css">
		#codescontainer1 {position:absolute;left:11em;width:9%}
		#codescontainer1 .yui-ac-content {position:absolute;width:100%;border:1px solid #404040;background:#fff;overflow:hidden;z-index:9050;}
		#codescontainer1 .yui-ac-shadow {position:absolute;margin:.3em;width:100%;background:#a0a0a0;z-index:9049;}
		#codescontainer1 ul {padding:5px 0;width:100%;}
		#codescontainer1 li {padding:0 5px;cursor:default;white-space:nowrap;}
		#codescontainer1 li.yui-ac-highlight {background:#ff0;}
		#codescontainer1 li.yui-ac-prehighlight {background:#FFFFCC;}
	</style>
		<script language="javascript">
		var l_relType=2;
		var mde="";
		var bankFundis="";
		var sIndex,sValue,sText;
		var cIndex,cValue,cText;
		var supplierNameArray,contractorNameArray;
		var	contractorArrayObj,supplierArrayObj  ;
		var yuiflag = new Array();
		var yuiflag1 = new Array();


function loadWorkOrderData(obj){
	if(obj.selectedIndex==-1)return;

	var workOrderID=obj.options[obj.selectedIndex].value;

	PageManager.DataService.setQueryField('workOrderID',workOrderID);
	PageManager.DataService.callDataService('maxAdvance');
	PageManager.DataService.callDataService('WorkFundBank');
}
function loadWorkOrders(splCode){
	if(splCode==null || splCode=="")return;
	PageManager.DataService.setQueryField('supplierCode',splCode);
	var obj=document.getElementById('worksDetail_id');
	obj.setAttribute('exilListSource','worksDetail_id');
	clearCombo('worksDetail_id');
	PageManager.DataService.callDataService('workOrderListForAdv');
}
function displayCode()
{
document.getElementById('relation_id').value=document.getElementById('contractor_supplier_id').value;

var conObj=document.getElementById("contractor_supplier_code");
loadWorkOrders(conObj.value);
}


 function hideButtons(){

					document.getElementById('modGrid').style.display="block";
					document.getElementById('submitGrid').style.display ="none";

		}
		function hideBut(){

			document.getElementById('modGrid').style.display="none";
			document.getElementById('submitGrid').style.display ="block";

		}


function clearCombo(cId)
{
   var bCtrl=document.getElementById(cId);
   for(var i=bCtrl.options.length-1;i>=0;i--)
   {
   	bCtrl.remove(i);
   }
   var maxAdvObj=document.getElementById('worksDetail_advancePayable');
   maxAdvObj.value="";
}
function onBodyLoad(){
	document.getElementById('reverseSubmit').style.display ="none";
	document.getElementById('egUser_id').value = CookieManager.getCookie('currentUserId');
	PageValidator.addCalendars();
	var drillDownCgno=PageManager.DataService.getQueryField('drillDownCgn');
	var sm=PageManager.DataService.getQueryField('showMode');

	if(drillDownCgno )
	{

		if(sm=="edit"){
				mde="edit";
				//PageManager.DataService.callDataService('miscReceiptList');
				var bankObj=document.getElementById('bank_id');
				bankObj.removeAttribute('exilListSource');
				bankObj.setAttribute('exilListSource','bankAndBranch');
				var aObj = document.getElementById('accountGroup_accountNumberId');
				aObj.setAttribute('exilListSource','accountList');

				var wObj=document.getElementById('worksDetail_id');

				wObj.setAttribute('exilListSource','worksDetail_id');
				PageManager.DataService.setQueryField('cgNumber',drillDownCgno);
				PageManager.DataService.removeQueryField('fundValue');

				PageManager.DataService.callDataService('loadSubLedgerAdvanceData');

				//obj.setAttribute('exilListSource','conBillDetail_worksDetailID');
				document.getElementById('voucherHeader_voucherNumber').setAttribute('exilDataType','exilAlphaNumeric');
		  		document.getElementById('modGrid').style.display='none';
		  		document.getElementById('submitGrid').style.display ='block';
		  		document.getElementById('saveandnew').style.display ="none";
		  		document.getElementById('cgnLabel').style.display='block';
		  		document.getElementById('cgnText').style.display='block';
		  		document.getElementById('backbutton').style.display='none';
		  		//document.forms[0].voucherHeader_voucherNumber.disabled=true;
		 		document.getElementById('modeOfExec').value="edit";
		 		document.getElementById('screenName').innerHTML="Advance Payment -Modify";

		 		}
		 	 else{

				window.cgnSet=true;
				window.data=true;
				disableControls(0,true);
				hideButtons();
				if(sm=="modify"){
					document.getElementById('modGrid').style.display='block';
					 document.getElementById('backbutton').style.display="none";
				}else{
					document.getElementById('modGrid').style.display='none';
					 document.getElementById('backbutton').style.display='block';

				}

				document.getElementById('voucherHeader_voucherNumber').setAttribute('exilDataType','exilAlphaNumeric');
				document.getElementById('cgnLabel').style.display='block';
				document.getElementById('cgnText').style.display='block';
				//document.getElementById('bankbal').style.display='none';
				document.getElementById('submitGrid').style.display ="none";
				var bankObj=document.getElementById('bank_id');
				bankObj.removeAttribute('exilListSource');
				bankObj.setAttribute('exilListSource','bankAndBranch');
				var aObj = document.getElementById('accountGroup_accountNumberId');
				aObj.setAttribute('exilListSource','accountList');
				var wObj=document.getElementById('worksDetail_id');
				wObj.setAttribute('exilListSource','worksDetail_id');
				PageManager.DataService.callDataService('loadSubLedgerAdvanceData');
		}

	}
	else{
		hideBut();
		 document.getElementById('backbutton').style.display="none";
		PageManager.ListService.callListService();
		PageManager.DataService.callDataService('cgNumber');
		document.advanceJournal.voucherHeader_voucherNumber.focus();
	}

		/*
	 * The following code for contractor's name-code-id implements Ajax autocomplete through YUI.
	 *
	 */
	       var type='getActiveContractorListwithCode';
            var url = "../commons/Process.jsp?type=" +type+ " ";
           	var req2 = initiateRequest();
            req2.onreadystatechange = function()
            {
	                  if (req2.readyState == 4)
	                  {
	                      if (req2.status == 200)
	                      {
	                      	var codes2=req2.responseText;
	                      	var a = codes2.split("^");
							var codes = a[0]; //alert(acccodeArray);
							contractorNameArray=codes.split("+");
							contractorArrayObj = new YAHOO.widget.DS_JSArray(contractorNameArray);
	                      }
	                  }
	        };
	        req2.open("GET", url, true);
	        req2.send(null);

		/*
		 * The following code implements Ajax autocomplete through YUI for supplier's name-code-id.
		 *
		 */
			  var type='getActiveSupplierListwithCode';
			  var url1 = "../commons/Process.jsp?type=" +type+ " ";
				var req3 = initiateRequest();

			  req3.onreadystatechange = function()
			  {		//codeObj=null;
					   if (req3.readyState == 4)
					   {
						  if (req3.status == 200)
						  {
							var codes2=req3.responseText;
							var a = codes2.split("^");
								var codes = a[0];
								supplierNameArray=codes.split("+");
								supplierArrayObj = new YAHOO.widget.DS_JSArray(supplierNameArray);
						  }
					   }
			   };
			   req3.open("GET", url1, true);
			   req3.send(null);

}

		function autocompleteNames(obj)
		{
			//document.getElementById('bankRow').style.display="none";
			// set position of dropdown
			var src = obj;
			var type=document.getElementById('subLedgerPaymentHeader_typeOfPayment').value;


			var currRow=PageManager.DataService.getRow(obj);  //alert("type:"+type);
			if(type=='supplier')
			{	document.getElementById('codescontainer1').style.display="none";
				document.getElementById('codescontainer').style.display="block";
				var target = document.getElementById('codescontainer');
				var posSrc=findPos(src);
				target.style.left=posSrc[0];
				target.style.top=posSrc[1]+25;
				target.style.width=500;
				if(yuiflag[currRow.rowIndex] == undefined)
				{

				//40 --> Down arrow, 38 --> Up arrow
							if(event.keyCode != 40 )
							{
								if(event.keyCode != 38 )
								{
										var oAutoComp = new YAHOO.widget.AutoComplete(obj,'codescontainer', supplierArrayObj);
										oAutoComp.queryDelay = 0;
										oAutoComp.prehighlightClassName = "yui-ac-prehighlight";
										oAutoComp.useShadow = true;
										oAutoComp.useIFrame = true;
								}
							}
							yuiflag[currRow.rowIndex] = 1;
				}
			}else if(type=='contractor')
			{
				document.getElementById('codescontainer').style.display="none";
				document.getElementById('codescontainer1').style.display="block";
				var target = document.getElementById('codescontainer1');
				var posSrc=findPos(src);
				target.style.left=posSrc[0];
				target.style.top=posSrc[1]+25;
				target.style.width=500;
				if(yuiflag1[currRow.rowIndex] == undefined)
				{

				//40 --> Down arrow, 38 --> Up arrow
							if(event.keyCode != 40 )
							{
								if(event.keyCode != 38 )
								{
										var oAutoComp = new YAHOO.widget.AutoComplete(obj,'codescontainer1', contractorArrayObj);
										oAutoComp.queryDelay = 0;
										oAutoComp.prehighlightClassName = "yui-ac-prehighlight";
										oAutoComp.useShadow = true;
										oAutoComp.useIFrame = true;
								}
							}
							yuiflag1[currRow.rowIndex] = 1;
				}
			}
		}

		/*fills id and description objects next to names
		 *neibrObjName1 = id  neibrObjName2 = description
		 */
		 function fillNeibrAfterSplit(obj,neibrObjName1,neibrObjName2)
		 {
			neibrObj1=document.getElementById(neibrObjName1);
			//var neibrObj2= PageManager.DataService.getControlInBranch(currRow,'neibrObjName2');
			neibrObj2=document.getElementById(neibrObjName2);
			var temp = obj.value; temp = temp.split("`-`");
			var temp1=new Array(2);
			temp1=temp[0].split("`--`");
			obj.value=temp1[0];

			//trimming begining and ending spaces
			var s = obj.value.replace(/^(\s)*/, '');
		    obj.value = s.replace(/(\s)*$/, '');

			if(obj.value==null || obj.value=="") { neibrObj1.value=""; neibrObj2.value=""; return; }

			if(temp[1]==null && (neibrObj1.value!='' || neibrObj1.value!=null || neibrObj2.value!='' || neibrObj2.value!=null) ) {  return ;}
			else {
					neibrObj1.value = temp[1];
					neibrObj2.value=temp1[1];
				 }
		document.getElementById('bankRow').style.display="block";
		 }


function edit(){
				var cgn=PageManager.DataService.getQueryField('drillDownCgno');
		 		if(cgn){
		 			//document.forms[0].voucherHeader_cgn.disabled=true;
		 			document.forms[0].voucherHeader_voucherNumber.disabled=true;
		 			document.getElementById('submitGrid').style.display ="block";
					document.getElementById('modeOfExec').value="edit";
					//enableControls(0,false);
		 	 	}
		}

function afterRefreshPage(dc)
{

		if (dc.values['serviceID']=='loadSubLedgerAdvanceData' )
		{
			var ctr= document.getElementById('accountGroup_accountNumberId'); //alert(ctr);
			accntMod(ctr);
			document.getElementById("contractor_supplier_id").value=dc.values['relation_id'];
		}
		var sm=PageManager.DataService.getQueryField('showMode');
		if (sm=='edit' && dc.values['serviceID']=='loadSubLedgerAdvanceData' )
		{
				document.getElementById("voucherHeader_voucherNumberPrefix").style.display="block";
				var vnum=dc.values['voucherHeader_voucherNumber'];
				var subVnum=vnum.substring(0,2);

				   document.getElementById("voucherHeader_voucherNumber").value=vnum.substring(2,vnum.length);
				   document.getElementById("voucherHeader_voucherNumberPrefix").value=subVnum;

				document.getElementById("jv_voucherNumberPrefix").style.display="block";
				var vnum=dc.values['jv_voucherNumber'];
				var subVnum=vnum.substring(0,2);

				 document.getElementById("jv_voucherNumber").value=vnum.substring(2,vnum.length);
				 document.getElementById("jv_voucherNumberPrefix").value=subVnum;


				   var voucherHeader_voucherDate=dc.values['voucherHeader_voucherDate'];
				   var voucherDate=formatDateToDDMMYYYY4(voucherHeader_voucherDate);
				   document.getElementById('voucherHeader_voucherDate').value=voucherDate;
				    if(document.getElementById("oldVoucherDate").value == "")
					{
						document.getElementById("oldVoucherDate").value=formatDateToDDMMYYYY4(dc.values['voucherHeader_voucherDate']);
					}
				//alert(document.getElementById("oldVoucherDate").value);
		 		loadBankBalance();
		}

			if(dc.values['databaseDate']!='' && dc.values['serviceID']=='cgNumber')
			{
			var dt=dc.values['databaseDate']
			document.getElementById('voucherHeader_voucherDate').value=dt;
			document.getElementById('chequeDetail_chequeDate').value=dt;

			}
			if(dc.values['serviceID']=='contraBalNumberF')
			{
			document.getElementById('bank_bal').value=dc.values['balAvailable'];
			}
var voucherHeader_voucherDate=dc.values['voucherHeader_voucherDate'];
if(dc.values['serviceID']!='contraBalNumberF' && dc.values['serviceID']!='accNumber'){
	if(voucherHeader_voucherDate){
	var voucherDate=formatDateToDDMMYYYY4(voucherHeader_voucherDate);
	document.getElementById('voucherHeader_voucherDate').value=voucherDate;
		}
	}
	var chequeDetail_chequeDate=dc.values['chequeDetail_chequeDate'];
	if(chequeDetail_chequeDate){
	chequeDetail_chequeDate=formatDateToDDMMYYYY4(chequeDetail_chequeDate);
	document.getElementById('chequeDetail_chequeDate').value=chequeDetail_chequeDate;
	}

	if(mde=="edit" && dc.values['serviceID']=='loadSubLedgerAdvanceData')
	{
	document.getElementById('worksDetail_oldAmount').value=dc.values['contracotrBillDetail_advanceA'];
	document.getElementById('worksDetail_oldWorksdetailId').value=dc.values['worksDetail_id'];

	}
	if( dc.values['serviceID']=='AccountFundMap1')
	{
		//alert("Bank Fund :"+document.getElementById('fund1_id').value);
		 bankFundis=document.getElementById('fund1_id').value;
		// alert("bankFundis ***"+bankFundis);
	}

}



function beforeRefreshPage(dc)
{//alert("Bank Fund in beforeRefreshPage:"+document.getElementById('fund1_id').value);
	if(dc.values['serviceID']=='contraBalNumberF')
		PageManager.DataService.removeQueryField('voucherHeader_voucherDate');

	if(dc.values['glCodeName'])
		{
		  glNameCode=dc.values['glCodeName'];
		 showEntry();
	}
	if(dc.values['serviceID']=='loadSubLedgerAdvanceData'){
		dc.values['contracotrBillDetail_advanceAmount']=dc.values['contracotrBillDetail_advanceA'];
		document.getElementById("oldAmount").value=dc.values['contracotrBillDetail_advanceA'];
		dc.values['subLedgerPaymentHeader_typeOfPayment']=dc.values['typeOfPayment'];
	}
	if(isNaN(parseInt(dc.values['voucherHeader_cgn']))) return;
	dc.values['voucherHeader_cgn'] = 'ASP' + dc.values['voucherHeader_cgn'];



}
			function checkNarration(narration)
			{
				if(narration.value.length>=250){
				  alert("Narration Cannot Be More Than " + 250 + " Characters");
				  return false;
				}
				return true;
			}

			function changeLabel()
			{
				var table = document.getElementById('TABLE1');
				var paymentType = document.getElementById('subLedgerPaymentHeader_typeOfPayment');
				var codeLabel = 'Contractor / Supplier Code<SPAN class="leadon">*</SPAN>';
				var refLabel = 'Work Order / PO Ref Code<SPAN class="leadon">*</SPAN>';
				if(paymentType.options[paymentType.selectedIndex].value.toLowerCase() == 'contractor'){
					codeLabel = 'Contractor Code<SPAN class="leadon">*</SPAN>';
					refLabel = 'Work Order Ref No.<SPAN class="leadon">*</SPAN>';
					l_relType=2;
				}
				if(paymentType.options[paymentType.selectedIndex].value.toLowerCase() == 'supplier'){
					codeLabel = 'Supplier Code<SPAN class="leadon">*</SPAN>';
					refLabel = 'PO Ref No.<SPAN class="leadon">*</SPAN>';
					l_relType=1;
				}

				table.rows[3].childNodes[0].childNodes[0].innerHTML = codeLabel;

				table.rows[3].childNodes[2].childNodes[0].innerHTML = refLabel;
				document.getElementById('contractor_supplier_code').value = '';
				clearCombo('worksDetail_id');
			}

			function loadConSupCode(){
				var typeId;
				var typeObj = document.getElementById('subLedgerPaymentHeader_typeOfPayment');
				if(typeObj.value=='contractor')
					typeId=2;
				else
					typeId=1;
				var obj = document.getElementById('contractor_supplier_name');
				PageManager.DataService.setQueryField('relationType',typeId);
				PageManager.DataService.callDataService('codeAndDescriptionCombo');
			}


			function openSearch(obj)
			{
				var a = new Array(2);
				var tableName;
				/************/
				var ctrl = document.getElementById('subLedgerPaymentHeader_typeOfPayment');
				var tableName = ctrl.options[ctrl.selectedIndex].text;

				var sRtn = showModalDialog("Search.html?tableNameForCode=relation&relationType="+l_relType,"","dialogLeft=300;dialogTop=210;dialogWidth=305pt;dialogHeight=300pt;status=no;");
				if(sRtn != '')
				{
					a = sRtn.split("`~`");

			 		var x = PageManager.DataService.getControlInBranch(obj.parentNode,'contractor_supplier_code');
			 		var y = document.getElementById('relation_id');
			 		x.value = a[0];
			 		y.value = a[2];
			 		loadWorkOrders(a[0]);
				}
			}

			function getAccountNumbers()
			{
				var ctrl = document.getElementById('bank_id');
				var branchid = ctrl.options[ctrl.selectedIndex].value;
				var a = Array(2);
				var obj = document.getElementById('accountGroup_accountNumberId');
				removeCombo(obj);
				sIndex=null;//Need to assign null to avoid concatination of description with previous Bank related Accnt No.
				a = branchid.split('-');
				branchid = a[1];
				document.getElementById("acc_Desc").value="";
				//alert("branchid :"+branchid+"branchid :"+a[0]);

				obj.setAttribute('exilListSource','accountList');
				PageManager.DataService.setQueryField('branchId',branchid);
			//	PageManager.DataService.setQueryField('fundValue',document.getElementById('fund_id').value);
				PageManager.DataService.callDataService('accNumber');

			}



		function ButtonPress(name)
		{
			if(name.toLowerCase()=='savenew')
			str="new";
			if(name.toLowerCase()=='saveclose')
			str="close";
		   var drillDownCgno=PageManager.DataService.getQueryField('drillDownCgn');
		   if(drillDownCgno )
			{
				disableControls(0,false);
	        }
	        else
	        {
			if(!PageValidator.validateForm())
				return false;
			if(!validate())
				return false;
			if(!checkFund())
				return false;
			if(!checkBalance())
			      return false;
			}

		 		var dbDate=document.getElementById('databaseDate').value;
				var vhDate=document.getElementById('voucherHeader_voucherDate').value;
				if(compareDate(formatDateToDDMMYYYY1(vhDate),formatDateToDDMMYYYY1(dbDate)) == -1 )
				{
				alert('Voucher Date should be less than or equal to '+dbDate);
				document.getElementById('voucherHeader_voucherDate').focus();
				return false;
				}
				var sm=PageManager.DataService.getQueryField('showMode');
				if(sm=='modify')
				{

					if(!checkFundReverse())
					return false;
					var effDate=document.getElementById('voucherHeader_effDate').value;
					if(compareDate(formatDateToDDMMYYYY1(effDate),formatDateToDDMMYYYY1(dbDate)) == -1 ){
					alert('Voucher Date should be less than or equal to '+dbDate);
					document.getElementById('voucherHeader_effDate').focus();
					return false;

				}
				}
			if(sm=='edit'){
			    if(!checkBalance())
			      return false;
				if(!validate())
				return false;
				if(!checkFund())
				return false;
			}
			PageManager.UpdateService.submitForm('advanceJournal');
		}

		function validate(){
			var maxAdvObj=document.getElementById('worksDetail_advancePayable');
			var advObj=document.getElementById('contracotrBillDetail_advanceAmount');
			var advPaidObj=document.getElementById('worksDetail_advanceAmount');
			if(!checkChequeDate("chequeDetail_chequeDate")) return false;
			if(!checkNarration(document.getElementById('voucherHeader_narration')))
				return false;
			if(parseFloat(advObj.value)<=0){
				alert('Enter Transaction  Amount Greater Than Zero');
				return false;
			}
			//alert("Advance"+parseFloat(advObj.value)+"***Advance Paid"+parseFloat(advPaidObj.value)+"***Max Advance"+parseFloat(maxAdvObj.value));
			if((parseFloat(advObj.value)+parseFloat(advPaidObj.value))>parseFloat(maxAdvObj.value)){
				alert('Advance crossed Max advance.Max:'+maxAdvObj.value);
				return false;
			}
			return true;
		}

		function afterUpdateService(dc)
		{
			 disableControls(0,true);
			if(str=="new")	window.location = "AdvanceJournal.htm"
			if(str=="close") window.close()

		}

	function disableControls(frmIndex, isDisable){
			for(var i=0;i<document.forms[frmIndex].length;i++)
			{
				document.forms[frmIndex].elements[i].disabled =isDisable;
				if(PageManager.DataService.getQueryField('showMode')=='view' && 
					document.forms[frmIndex].elements[i].parentNode.parentNode.getAttribute('id')=='backbutton')
					document.forms[frmIndex].elements[i].disabled =false;
				if(PageManager.DataService.getQueryField('showMode')=='modify' 
						&& (document.forms[frmIndex].elements[i].parentNode.parentNode.getAttribute('id')=='modGrid' ||
						 document.forms[frmIndex].elements[i].parentNode.parentNode.getAttribute('id')=='reverseSubmit' ))
					document.forms[frmIndex].elements[i].disabled =false;
			}
		}
		function onClickCancel()
		{
			window.location = "AdvanceJournal.htm"
		}
		function reverse()
			{
			var cgn=PageManager.DataService.getQueryField('drillDownCgn');
			if(cgn){
				document.getElementById('reverseRecord').style.display='block';
				var vcObj=document.getElementById('voucherHeader_newVcNo');
				vcObj.setAttribute('exilMustEnter','true');
				vcObj.disabled=false;
				var jvcObj=document.getElementById('voucherHeader_newJVcNo');
				jvcObj.disabled=false;
				var vdObj=document.getElementById('voucherHeader_effDate')
				vdObj.setAttribute('exilMustEnter','true');
				vdObj.disabled=false;
				var bcObj=document.getElementById('diffDebit')
				bcObj.disabled=false;
				document.getElementById('modeOfExec').value="modify";
				document.getElementById('reverseSubmit').style.display ="block";
			}
		}
		function showglEntry()
		{
			hideColumn(0);
			displayColumn(1);
			displayColumn(2);
			displayColumn(3);
			displayColumn(4);
			displayColumn(5);
			if(!PageValidator.validateForm())
				return false;
			PageManager.DataService.setQueryField("showGlEntries","show");
			PageManager.DataService.setQueryField("showJVGlEntries","no");
			var accNumberObj=document.getElementById("accountGroup_accountNumberId");
			var accNumberType=accNumberObj.options[accNumberObj.selectedIndex].value
			PageManager.DataService.setQueryField("accountNumberId",accNumberType);
			var typeObj=document.getElementById("subLedgerPaymentHeader_typeOfPayment");
			var payType=typeObj.options[typeObj.selectedIndex].value
			PageManager.DataService.setQueryField("typeOfPayment",payType);
			//alert("Work order fund:"+document.getElementById("fund_id").value+" Bank Fund :"+bankFundis)
			bankFundis=document.getElementById("fund1_id").value;
			PageManager.DataService.setQueryField("fund_id",document.getElementById("fund_id").value);
			PageManager.DataService.setQueryField("fund1_id",bankFundis);
			PageManager.DataService.callDataService('advanceJournal');
		}

		function showJVglEntry()
		{
		//alert("WO Fund:"+document.getElementById('fund_id').value+" Bank Fund:"+bankFundis)
				 if(document.getElementById('fund_name').value==document.getElementById('fund1_name').value)
	    		 {
	    			alert("There is no Journal Entry passed.");
	    			hideColumn(1);
	    			hideColumn(2);
	    			hideColumn(3);
	    			hideColumn(4);
	    			hideColumn(5);
	    			return;
				 }
				 else{
				 	hideColumn(0);
				 	displayColumn(1);
				 	displayColumn(2);
				 	displayColumn(3);
				 	displayColumn(4);
				 	displayColumn(5);

					if(!PageValidator.validateForm())
						return false;
					PageManager.DataService.setQueryField("showGlEntries","show");
					PageManager.DataService.setQueryField("showJVGlEntries","yes");
					var accNumberObj=document.getElementById("accountGroup_accountNumberId");
					var accNumberType=accNumberObj.options[accNumberObj.selectedIndex].value
					PageManager.DataService.setQueryField("accountNumberId",accNumberType);
					var typeObj=document.getElementById("subLedgerPaymentHeader_typeOfPayment");
					var payType=typeObj.options[typeObj.selectedIndex].value
					PageManager.DataService.setQueryField("typeOfPayment",payType);
					PageManager.DataService.setQueryField("fund_id",document.getElementById("fund_id").value);
					PageManager.DataService.setQueryField("fund1_id",document.getElementById("fund1_id").value);
					PageManager.DataService.callDataService('advanceJournal');
				}
		}

		function showEntry()
		{
			var trObj;
			var tObj=document.getElementById("showEntries");
			var cr=0,dr=0;
			tObj.style.display="block";
			var tableObj=document.getElementById("entries");
			for(var i=tableObj.rows.length-1;i>=2;i--)
			{
				tableObj.deleteRow(i);
			}
			var Obj=PageManager.DataService.getControlInBranch(tableObj.rows[1],"display_Code");
			trObj=PageManager.DataService.getRow(Obj);
			var iRow=glNameCode.split(";");
			var rowContents=null;tempObj=null;
			for(var i=1;i<(iRow.length)-1;i++)
			{
				rowContents=iRow[i].split("^");
				if(i==1){
				newRow=trObj;
				tempObj1=PageManager.DataService.getControlInBranch(newRow,'display_CodeType');
				tempObj1.innerHTML=rowContents[0];
				tempObj2=PageManager.DataService.getControlInBranch(newRow,'display_Code');
				tempObj2.innerHTML=rowContents[1];
				tempObj3=PageManager.DataService.getControlInBranch(newRow,'display_Head');
				tempObj3.innerHTML=rowContents[2];
				tempObj5=PageManager.DataService.getControlInBranch(newRow,'display_Narration');
				tempObj5.innerHTML=" -";
				}else{
				var newRow=trObj.cloneNode(true);
				newRow=tableObj.tBodies[0].appendChild(newRow);
				tempObj1=PageManager.DataService.getControlInBranch(newRow,'display_CodeType');
				tempObj1.innerHTML=rowContents[0];
				tempObj2=PageManager.DataService.getControlInBranch(newRow,'display_Code');
				tempObj2.innerHTML=rowContents[1];
				tempObj3=PageManager.DataService.getControlInBranch(newRow,'display_Head');
				tempObj3.innerHTML=rowContents[2];
				tempObj5=PageManager.DataService.getControlInBranch(newRow,'display_Narration');
				tempObj5.innerHTML=" -";
				}

			}
			var totalamount=document.getElementById('contracotrBillDetail_advanceAmount').value;

			for(var i=1;i<tableObj.rows.length;i++)
			{
				var typeObj=PageManager.DataService.getControlInBranch(tableObj.rows[i],"display_CodeType");
				var type=typeObj.innerHTML;
				if(type =='credit')
				{
					var trObj=PageManager.DataService.getRow(typeObj);
					col1=PageManager.DataService.getControlInBranch(trObj,'display_Credit');
					col1.innerHTML=totalamount;
					col2=PageManager.DataService.getControlInBranch(trObj,'display_Debit');
					col2.innerHTML="0";
				}
			}
			for(var i=1;i<tableObj.rows.length;i++)
			{
				var typeObj=PageManager.DataService.getControlInBranch(tableObj.rows[i],"display_CodeType");
				var type=typeObj.innerHTML;
				if(type =='debit')
				{
					var trObj=PageManager.DataService.getRow(typeObj);
					col1=PageManager.DataService.getControlInBranch(trObj,'display_Credit');
					col1.innerHTML="0";
					col2=PageManager.DataService.getControlInBranch(trObj,'display_Debit');
					col2.innerHTML=totalamount;
				}
			}

			 var dSum=0;
			 var cSum=0;
			for(var i=1;i<tableObj.rows.length;i++)
			{

			  var dObj=PageManager.DataService.getControlInBranch(tableObj.rows[i],"display_Debit");
			  var cObj=PageManager.DataService.getControlInBranch(tableObj.rows[i],"display_Credit");
			 if(!isNaN(parseFloat(dObj.innerHTML)))
			 {
			   var sum=(parseFloat(dObj.innerHTML));
			   dSum=dSum+sum;
			 }
			 if(!isNaN(parseFloat(cObj.innerHTML)))
			 {
			   var sum=(parseFloat(cObj.innerHTML));
			   cSum=cSum+sum;
			 }
			}
			var newRow=trObj.cloneNode(true);
			newRow=tableObj.tBodies[0].appendChild(newRow);
			objt1=PageManager.DataService.getControlInBranch(newRow,'display_Code');
			objt2=PageManager.DataService.getControlInBranch(newRow,'display_Head');
			objt3=PageManager.DataService.getControlInBranch(newRow,'display_Debit');
			objt4=PageManager.DataService.getControlInBranch(newRow,'display_Credit');
			objt5=PageManager.DataService.getControlInBranch(newRow,'display_Narration');
			objt1.innerHTML=" ";
			objt2.innerHTML=" ";
			objt3.innerHTML=dSum;
			objt4.innerHTML=cSum;
			objt5.innerHTML=" ";

	}

	function hideColumn(index)
	{
		var table=document.getElementById('entries');
	   	for(var i=0;i<table.rows.length;i++){
			table.rows[i].cells[index].style.display="none";
	   	}
	}

	function displayColumn(index)
		{
			var table=document.getElementById('entries');
		   	for(var i=0;i<table.rows.length;i++){
				table.rows[i].cells[index].style.display="block";
		   	}
	}
		function loadBankBalance()
		{
			var ctr= document.getElementById('accountGroup_accountNumberId');
			var voucherHeader_voucherDate=document.getElementById('voucherHeader_voucherDate').value;
			    if(!voucherHeader_voucherDate)
			   {
			    	alert("Please select the Voucher Date ");
			    	return;
			   }
			   if(ctr.selectedIndex != -1){
			     var bal_from=ctr.options[ctr.selectedIndex].value;
			     PageManager.DataService.setQueryField('voucherHeader_voucherDate',voucherHeader_voucherDate);
			     PageManager.DataService.setQueryField('bal_from',bal_from);
			     PageManager.DataService.callDataService('contraBalNumberF');
				}
	}
	function checkBalance()
	{
	    var amt=document.getElementById("contracotrBillDetail_advanceAmount").value;
		var bal=document.getElementById("bank_bal").value;
		bal=isNaN(bal)?0:bal;
		var finalBal=bal-amt;
		if(finalBal<0)
		{
		  if(!confirm("WARNING:  Insufficient Balance in Bank-Account"))
		    return false;
		}
		return true;
	}

	function checkFund()
	{
	    if(document.getElementById('fund_id').value!=document.getElementById('fund1_id').value)
	    {
			  if(!confirm("WARNING:This will be an Inter Fund Transfer."))
				    return false;
			else{
				if(document.getElementById("jv_voucherNumber").value.length==0){
					alert("Enter value for Journal Voucher Number.");
					return false;
				}
			}
		}
		else{
			document.getElementById("jv_voucherNumber").value='';
			}

		return true;
	}

	function checkFundReverse()
		{
		    if(document.getElementById('fund_id').value!=document.getElementById('fund1_id').value)
		    {
					if(document.getElementById("voucherHeader_newJVcNo").value.length==0){
						alert("Enter value for Journal Voucher Number.");
						document.getElementById("voucherHeader_newJVcNo").focus();
						return false;
					}

			}
			else
				document.getElementById("voucherHeader_newJVcNo").value='';

			return true;
	}

	function loadFund(obj){
				if(obj.selectedIndex==-1) return;
				bankFundis="";
				accntMod(obj);
				var accId=obj.options[obj.selectedIndex].value;
				PageManager.DataService.setQueryField('bankIdForFund',accId);
				PageManager.DataService.callDataService('AccountFundMap1');
				loadBankBalance();
				//document.getElementById('fund_id').value!=document.getElementById('fund1_id').value


		}
function accntMod(obj)
{
	//try{
	//alert("in mod:"+obj.selectedIndex);
	if(obj.selectedIndex==-1)	 return;
	 if(sIndex!=null)
	{
			obj.options[sIndex]= new Option(sText,sValue);
	}
	//alert("try");
	var text=obj.options[obj.selectedIndex].innerHTML;
    var temp=text.split(" -- ");
	sIndex=obj.selectedIndex;
	sValue=obj.options[obj.selectedIndex].value;
	sText=text;//alert("wat abt here?");
	if(!temp[1])
		 temp[1]=" ";
	//alert(temp[1]);
	document.getElementById("acc_Desc").value=temp[1];
	try{
	   if(temp[1]!=null && temp[1]!="" )
	   {
	     obj.options[obj.selectedIndex].text=temp[0];
	   }
   }catch(err){}
}
function removeCombo(obj)
{
  for(var i=obj.options.length;i>=0;i--)
      obj.remove(i);
}

function nextChqNo()
{
	var obj=document.getElementById("accountGroup_accountNumberId");
	var bankBr=document.getElementById("bank_id");
	if( bankBr.selectedIndex==-1)
	{
	  alert("Select Bank Branch and Account No!!");
	  return;
	}

	if(obj.selectedIndex==-1)
	{
	  alert("Select Account No!!");
	  return;
	}
	var accNo=obj.options[obj.selectedIndex].text;
	var accNoId=obj.options[obj.selectedIndex].value;
	var sRtn =showModalDialog("SearchNextChqNo.html?accntNo="+accNo+"&accntNoId="+accNoId,"","dialogLeft=300;dialogTop=210;dialogWidth=305pt;dialogHeight=300pt;status=no;");
	if(sRtn!=undefined ) document.getElementById("chequeDetail_chequeNumber").value=sRtn;
}

	</script>


	</head>
	<body onLoad="onBodyLoad()" onKeyDown ="CloseWindow(event);" bgcolor="#ffffff" bottommargin="0" topmargin="0" rightmargin="0" leftmargin="0"
		 marginheight="0" marginwidth="0" ><!------------------ Header Begins Begins--------------------->
		<form name="advanceJournal">
				<input type=hidden id="modeOfExec" name="modeOfExec" value="new">
				<input type="hidden" name="egUser_id" id="egUser_id">
				<input type="hidden" name="relation_id" id="relation_id">
				<input type="hidden" name="budgetCheckRequired" id="budgetCheckRequired" value="true">
				<input type="hidden" name="tType" id="tType" value="P">
				<input type="hidden" name="cgnNum" id="cgnNum">
				<input type="hidden" name="oldAmount" id="oldAmount">
					<input type="hidden" name="voucherHeader_id" id="voucherHeader_id">
					<input type="hidden" name="oldVoucherDate" id="oldVoucherDate">
				<table width="100%" border="0" cellpadding="1" cellspacing="0">
					<tr>
						<td valign="top"><!------------Content begins here ------------------>
							<table width="100%" border="0" cellpadding="3" cellspacing="0" name="TABLE1" id=TABLE1>
       			 <TBODY>
								<tr class=tableheader style="display:none">
									<td class="" valign="center" colspan="3"><span id="screenName" class="screenName">  Advance Payment</span></td><td class="" valign="center" align="right"><a href='#' onclick=newWindow('../HTML/AddAccountCode.htm') ><span class="link">Add Account Code</span></a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="headerwhite1" align="centre"><a onclick="newWindow('../HelpAssistance/Advance Payment.htm')";><IMG height=20 src="../images/help.gif" width=40></a></span></td>
								</tr>
								<tr  >
									<td width="18%" id="cgnLabel" name="cgnLabel" align="right" valign="center" class="" style="DISPLAY: none"><span align="right" class=labelcell> CG&nbsp;Number&nbsp;&nbsp;</span>
									</td>
									<td width="31%" id="cgnText" name="cgnText" style="DISPLAY: none">
                                    <span class=fieldcell><input name="voucherHeader_cgn" class="fieldinput" id="voucherHeader_cgn" readOnly maxlength="10" exilMustEnter="true" exilDataType="exilAlphaNumeric" ></span>
									</td>
									<td  width="15%" align="right" valign="center" class="normaltext"><span align="right" class="labelcell">Voucher Number<span class="leadon">*</span></span>
									</td>
									<td width="33%">
									<table cellpadding="0" cellspacing="0" WIDTH="100">
							  		<tr class=fieldcell>
							  		<td><input name="voucherHeader_voucherNumberPrefix" maxlength="2" class="fieldinput-left" id="voucherHeader_voucherNumberPrefix" readonly style="display:none" style="width:25px" SIZE="1"></td>
							  		<td><input name="voucherHeader_voucherNumber" maxlength="10" class="fieldinput-left" id="voucherHeader_voucherNumber"  exilMustEnter="true" exilDataType="exilAlphaNumeric" SIZE="20" ></td>
							  		</tr>
							  		</table>
									</td>
					</tr>

				<tr >
					<td align="right" valign="center" class="normaltext"><span align="right" class=labelcell>Type Of Party<span class="leadon">*</span></span>
					</td>
					<td><span class="smallfieldcell">
                    <SELECT id="subLedgerPaymentHeader_typeOfPayment" name="subLedgerPaymentHeader_typeOfPayment" class="fieldinput" onChange="changeLabel()" exilMustEnter="true">
						<option value="contractor" selected
             >Contractor</option>
						<option value="supplier">Supplier</option>
                    </SELECT></span>
					</td>
					<td align="right"  class="normaltext" ><span align="right" class="labelcell">Voucher Date<SPAN class=leadon>*</SPAN>  </span></td>
					<td><span class=smallfieldcell><INPUT class=datefieldinput id="voucherHeader_voucherDate" name="voucherHeader_voucherDate" size ="13" maxlength="11" onkeyup="DateFormat(this,this.value,event,false,'3')" exilMustEnter="true" exilDataType="exilAnyDate" exilCalendar="true">&nbsp;</span></td>
                </tr>
					<tr >
						<td align="right" valign="center" class="normaltext"><span align="right" class="labelcell">
							Contractor Name<SPAN class=leadon>*</SPAN></span>
						</td>
						<td>
                    	<input  type="hidden" name="contractor_supplier_id" class="normaltext" id="contractor_supplier_id" maxlength="10"  exilMustEnter="true">
                    	<span class=fieldcell><input name="contractor_supplier_name" class= id="contractor_supplier_name" maxlength="50"  onblur="fillNeibrAfterSplit(this,'contractor_supplier_id','contractor_supplier_code');displayCode();"  autocomplete="off" onkeyup="autocompleteNames(this)" exilMustEnter="true"></span>
						<span class=smallfieldcell><input  name="contractor_supplier_code" id="contractor_supplier_code" class="accfieldinput" tabIndex=2  readOnly  ></input></span>
                   		 </td>


						<td align="right" valign="center" class="normaltext"><span align="right" class="labelcell">Work Order / PO Ref<SPAN class=leadon>*</SPAN></span>
						</td>
						<td><span class="smallfieldcell">
                        <select  class="fieldinput" id="worksDetail_id" name="worksDetail_id"
            onChange="loadWorkOrderData(this)" exilMustEnter="true"
            exilDataType="exilAlphaNumeric">
                         </select></span>
            <DIV></DIV>
						</td>
					</tr><span id="codescontainer"></span><span id="codescontainer1"></span>



					<tr  id="bankRow">
						<td align="right" valign="center" ><span align="right" class="labelcell"> Bank<SPAN class=leadon>*</SPAN> </span>
						</td>
						<td><span class="smallfieldcell">
						<SELECT id="bank_id" name="bank_id" class="combowidth1" onChange="getAccountNumbers()" width="120"  exilMustEnter="true" exilListSource="bankAndBranch">

                        <OPTION value="" selected>&nbsp;</OPTION>
                        </SELECT></span>
						</td>
						<td align="right" valign="center" class="normaltext"><span align="right" class="labelcell">Account Number<SPAN class=leadon>*</SPAN> </span>
						</td>
						<td><span class="smallfieldcell"><SELECT id="accountGroup_accountNumberId" name="accountGroup_accountNumberId" class="fieldinput" onChange="loadFund(this);loadBankBalance(this);" exilMustEnter="true"></SELECT><input type="text" id="acc_Desc" name="acc_Desc" class="fieldinput" tabindex=-1  readonly></span></td>
					</tr>

							<tr  id="bankbal">
							  <td align="right"><span align="right" valign="center" class="labelcell"> Bank Balance</span></td>
							  <td>
								<span class=fieldcell><input  name="bank_bal" id="bank_bal" class="fieldinput" tabindex=-1  readonly ></span>
							  </td>
							  <td align=right><span align="right" valign="center" class="labelcell"> Bank Fund</span></td>
							  <td>
							  			<input type=hidden name="fund1_id" id="fund1_id" class="fieldinput" >
							  			<span class=fieldcell><input name="fund1_name" id="fund1_name" class="fieldinput" tabindex=-1 readonly></span>

							  </td>
                            </tr>
					<tr >
						<td align="right" valign="center" class="normaltext"><span align="right" class="labelcell">Fund Name<SPAN class=leadon></SPAN></span>
						</td>
						<td><!--<SELECT id="fund_id" name="fund_id"  class="fieldinput" exilMustEnter="true" exilListSource="fundNameList">
								<OPTION value="" selected>&nbsp;</OPTION>
							</SELECT>&nbsp;-->
								<input type=hidden name="fund_id" id="fund_id" class="fieldinput" >
								<span class=fieldcell><input name="fund_name" id="fund_name" class="fieldinput" tabindex=-1 readonly></span>
						</td>
				<!--		<td align="right" valign="center" class="normaltext"><span align="right">Function<SPAN class=leadon>*</SPAN></span>
						</td>
						<td>
                        <SELECT id="department_id" name="department_id"  class="fieldinput" exilMustEnter="true" exilListSource="departmentNameList">
                        <OPTION value="" selected>&nbsp;</OPTION>
                        </SELECT>&nbsp;
						</td> -->
						<td align="right" valign="center" class="normaltext"><span align="right" class="labelcell">Financing Source<SPAN class=leadon></SPAN></span>
						</td>
						<td>	<input type=hidden name="fundSource_id" id="fundSource_id" class="fieldinput" >
								<span class=fieldcell><input name="fundSource_name" id="fundSource_name" class="fieldinput" tabindex=-1 readonly></span>
						</td>

					</tr>
					<tr >
						<td align="right" valign="center" class="normaltext"><span align="right" class="labelcell">Cheque No.<SPAN class=leadon>*</SPAN> </span></td>
						<td>
							<table width="25%">
								<tr class=fieldcell><td><input name="chequeDetail_chequeNumber" class="fieldinput" id="chequeDetail_chequeNumber" maxlength="10" exilMustEnter="true" exilDataType="exilUnsignedInt" ></td>
									<td valign="center" title="Show Next Cheque Number"  nowrap id="chqAvail"><A onclick=nextChqNo() href="#"><IMG height=22 src="../images/arrowright.gif" width=22 ></A></td>
								</tr>
							</table>
						</td>
						<td align="right" valign="center" class="normaltext"><span align="right" class="labelcell">Cheque Date<SPAN class=leadon>*</SPAN> </span>
						</td>
						<td><span class=smallfieldcell><input name="chequeDetail_chequeDate" class="datefieldinput" id="chequeDetail_chequeDate" size=13 maxlength="11" onkeyup="DateFormat(this,this.value,event,false,'3')" exilMustEnter="true" exilDataType="exilAnyDate" exilCalendar="true">&nbsp;</span></td>
					</tr>
					<tr >
						<td align="right" valign="center" class="normaltext"><span align="right" class="labelcell"> Advance&nbsp;Amount<SPAN class=leadon>*</SPAN></span>
						</td>
						<td>
                        <span class=fieldcell><INPUT class="fieldinput-right" id="contracotrBillDetail_advanceAmount" name="contracotrBillDetail_advanceAmount"   maxlength="16" exilMustEnter="true" exilDataType="exilUnsignedDecimal" exilMax="9999999999999.99" exilMin="1" >&nbsp;</span>
						</td>
						<td align="right" valign="center" class=""><span align="right" class="labelcell">Narration</span>
						</td>
						<td><TEXTAREA class=narrationfieldinput id=voucherHeader_narration name=voucherHeader_narration rows=3 cols=40 exilDataType="exilAnyChar"></TEXTAREA>&nbsp;
						</td>
					</tr>

<tr  id="jvinfo">
					<td  width="18%" align="right" valign="center" class="normaltext"><span align="right" class="labelcell">Journal Voucher Number<br><sup>
						(applicable only in case of inter fund transfer)</sup></span>
					</td>
					<!--<td><input name="jv_voucherNumber" maxlength="10" class="fieldinput-left" id="jv_voucherNumber"  exilDataType="exilAlphaNumeric" SIZE="20" >-->

					<td><table><tr class=smallfieldcell><td>
					<input name="jv_voucherNumberPrefix" maxlength="2" class="fieldinput-left" id="jv_voucherNumberPrefix" readonly style="display:none" style="width:25px" SIZE="1"></td>
					<td><input name="jv_voucherNumber" maxlength="10" class="fieldinput-left" id="jv_voucherNumber"   exilDataType="exilAlphaNumeric" SIZE="10" ></td>
					</tr></table></td>
					<td  colspan=2></td>

</tr>
					<tr >
						<td align="middle" colspan="4">
							&nbsp;
						</td>
					</tr>

					<td height="25" colspan="4" valign="bottom" ><p class="smalltext"><span class="leadon">*</span>
											- Mandatory Fields&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>


				</table>
				<table border="0" cellpadding="0" cellspacing="0" align="center" id=TABLE1 width="100%">
		<TBODY>
		<tr >
			<td colspan="4" align="middle"><!-- Buttons Start Here -->
				<table border="0" cellpadding="0" cellspacing="0" id=TABLE1 >
					<tbody>
					<tr id="modGrid">
										<td align="center" width=100% colspan=4>
										<input   type="button" class="button" value="Reverse" onclick=reverse(); />
										</td>
								</tr>
								<tr id="backbutton" >
									<td width=100% align=center colspan=4>
									<input   type="button" class="button" value="Back" onclick="back(window.self)" />

									</td>
								</tr>
						</tbody>
						</table>
						<table>
										<tr id="reverseRecord"  style="DISPLAY: none">
											<td  align="right"><span  align="right" valign="center" class="labelcell" style="width:175">Payment Voucher Number<SPAN class=leadon>*</SPAN></span></td>
											<td><span class=smallfieldcell><input name="voucherHeader_newVcNo" id="voucherHeader_newVcNo" maxlength="10"  style=" HEIGHT: 22" size="10"  exilDataType="exilAlphaNumeric"> </span></td>
											<td align="right"><span  valign="center" class="labelcell">Journal Voucher Number</span>
											<td><span class=smallfieldcell><input name="voucherHeader_newJVcNo" id="voucherHeader_newJVcNo" maxlength="10"  style="HEIGHT: 22" size="10" exilDataType="exilAlphaNumeric"> </span></td>
											<td align="right"><span   valign="center" class="labelcell" >Voucher Date<span class="leadon">*</span></td>
											<td><span class=smallfieldcell><INPUT class   ="datefieldinput"	name="voucherHeader_effDate" id="voucherHeader_effDate"onkeyup="DateFormat(this,this.value,event,false,'3')" exilDataType="exilAnyDate"  style="WIDTH: 101px; HEIGHT: 19px" size="13"   exilCalendar="true"></span></td>
											<td><INPUT  type=hidden class="datefieldinput" name="diffDebit" id="diffDebit" style   ="WIDTH: 101px; HEIGHT: 19px" size="13"></td>
										</tr>

										<tr>
										  <td colspan=4></td>
										</tr>
						</table>
			</td>
		</tr></TBODY></table><!-- Buttons End Here -->


					 <table border="0" cellpadding="0" cellspacing="0"  align="center">
							 <tr id="submitGrid">
							 <td>
							 <input  id="saveandnew" type="button" class="button" value="Save & New" onclick="return ButtonPress('savenew');"/>
							 <input   type="button" class="button" value="Save & Close" onclick="return ButtonPress('saveclose');" />
							 <input   type="button" class="button" value="Cancel" onclick="onClickCancel()" />
							 <input   type="button" class="button" value="Close" onclick=window.close(); />
							 <input   type="button" class="button" value="Show GlEntry" onclick=showglEntry(); />
							  <input   type="button" class="button" value="Show JV" onclick=showJVglEntry(); />
							 </td>
						</tr></table>
						 
							 <table align="center" border="0" cellpadding="0" cellspacing="0">
					 				<tr id="reverseSubmit">
					 						<td width=100% align=center>
						 						<input type="button"  id="revsave" value="Submit" class="button" onclick="return ButtonPress('saveclose');"/>
						 						<input type="button" id="revclose" value="Close" class="button" onclick="window.close();" />
					 						</td>
									</tr>
							</table>
							 

							 <table width="100%" border=0 cellpadding="3" cellspacing="0" id="showEntries" name="showEntries" style="DISPLAY: none">
								<tr >
								<td colspan=4>
								<table width="100%" align=center border="0" cellpadding="0" cellspacing="0" >
								<tr  height="25">
								 <TD class=displaydata align=center ><h4>GLEntry</h4></TD></tr>
								</table>
								</td>
								</tr>
								<tr><td>
								<table width="80%" border="1" cellpadding="0" cellspacing="0" align=center id="entries" name="entries">
								<tr class="thStlyle">
									<td class="" ><span align="center" valign="center" class=""> Code Type</span></td>
									<td  class=""><span align="center" valign="center" class=""> Account Code</span></td>
									<td  class=""><span align="center" valign="center" class=""> Account Head</span></td>
									<td  class=""><span align="center" valign="center" class=""> Debit </span></td>
									<td  class=""><span align="center" valign="center" class=""> Credit</span></td>
									<td  class=""><span align="center" valign="center" class=""> Narration</span></td>
								</tr>
								<tr class="labelcell">
									<td ><span name="display_CodeType"  id="display_CodeType"   readOnly maxLength=10 tabIndex=0>&nbsp;</span></td>
									<td ><span name="display_Code"  id="display_Code"   readOnly maxLength=10 tabIndex=0>&nbsp;</span></td>
									<td ><span name="display_Head"  id="display_Head"  readOnly maxLength=10 tabIndex=0>&nbsp;</span></td>
									<td ><span name="display_Debit"  id="display_Ddebit"  readOnly maxLength=16 tabIndex=0>&nbsp;</span></td>
									<td ><span name="display_Credit"  id="display_Credit"  readOnly maxLength=16 tabIndex=0>&nbsp;</span></td>
									<td ><span name="display_Narration" id="display_Narration"  readOnly maxLength=10 tabIndex=0>&nbsp;</span></td>
								</tr>
								</table>
								</td>
								</tr>
						</table>
						


				<!---------------- Footer begins here ----------><!---------------- Footer ends here ---------->
				<input type=hidden name=databaseDate  id=databaseDate/>
				<input type=hidden name="worksDetail_advancePayable" id="worksDetail_advancePayable"/>
				<input type=hidden name="worksDetail_advanceAmount" id="worksDetail_advanceAmount"/>
				<input type=hidden name="worksDetail_oldAmount" id="worksDetail_oldAmount"/>
				<input type=hidden name="worksDetail_oldWorksdetailId" id="worksDetail_oldWorksdetailId"/>
				<input type=hidden name="cvType" id="cvType" value="J"/>

		</form>
	</body>
</html>

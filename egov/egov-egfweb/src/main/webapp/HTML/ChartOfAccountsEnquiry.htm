#-------------------------------------------------------------------------------
# eGov suite of products aim to improve the internal efficiency,transparency, 
#      accountability and the service delivery of the government  organizations.
#   
#       Copyright (C) <2015>  eGovernments Foundation
#   
#       The updated version of eGov suite of products as by eGovernments Foundation 
#       is available at http://www.egovernments.org
#   
#       This program is free software: you can redistribute it and/or modify
#       it under the terms of the GNU General Public License as published by
#       the Free Software Foundation, either version 3 of the License, or
#       any later version.
#   
#       This program is distributed in the hope that it will be useful,
#       but WITHOUT ANY WARRANTY; without even the implied warranty of
#       MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#       GNU General Public License for more details.
#   
#       You should have received a copy of the GNU General Public License
#       along with this program. If not, see http://www.gnu.org/licenses/ or 
#       http://www.gnu.org/licenses/gpl.html .
#   
#       In addition to the terms of the GPL license to be adhered to in using this
#       program, the following additional terms are to be complied with:
#   
#   	1) All versions of this program, verbatim or modified must carry this 
#   	   Legal Notice.
#   
#   	2) Any misrepresentation of the origin of the material is prohibited. It 
#   	   is required that all modified versions of this material be marked in 
#   	   reasonable ways as different from the original version.
#   
#   	3) This license does not grant any rights to any user of the program 
#   	   with regards to rights under trademark law for use of the trade names 
#   	   or trademarks of eGovernments Foundation.
#   
#     In case of any queries, you can reach eGovernments Foundation at contact@egovernments.org.
#-------------------------------------------------------------------------------
<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
	<head>
	<title>
	View And Modify Chart Of Accounts
	</title>
		<SCRIPT LANGUAGE = "javascript">
		function getData(){
				document.getElementById("actionId").value=PageManager.DataService.getQueryField('actionId');
				//alert(document.getElementById("actionId").value);
				var Code = PageManager.DataService.getQueryField('chartOfAccounts_glCode');
				PageManager.DataService.setQueryField('chartOfAccounts_glCode',Code);
				PageManager.DataService.callDataService('chartOfAccountFullDetails');
				document.chartOfAccountsEnquiry.chartOfAccounts_glCode.focus();
		}

		function onClickGo(){
			var Code = document.chartOfAccountsEnquiry.chartOfAccounts_glCode.value;
			PageManager.DataService.setQueryField('chartOfAccounts_glCode',Code);
			PageManager.DataService.callDataService('chartOfAccountFullDetails');
			document.chartOfAccountsEnquiry.chartOfAccounts_glCode.focus();

		}
		function openSearch(obj){
			 var a    = new Array(2);
			 var sRtn = showModalDialog("Search.html?tableNameForCode=chartofaccounts","","dialogLeft=300;dialogTop=210;dialogWidth=305pt;dialogHeight=300pt;status=no;");
    		 if ( sRtn != '' ){
				a = sRtn.split("`~`");
				var type   = document.getElementById('chartOfAccounts_glCode');
				type.value = a[0];
				PageManager.DataService.setQueryField('chartOfAccounts_glCode',type.value);
				PageManager.DataService.callDataService('chartOfAccountFullDetails');
				document.chartOfAccountsEnquiry.chartOfAccounts_glCode.focus();
			}
		}
		function onClickModify(){

			document.getElementById('egUser_id').value = CookieManager.getCookie('currentUserId');
			//   ***1 only FO***,  ***2 FO***,  ***Admin, 3 All***    //
			if(!isValidUser(1, CookieManager.getCookie('userRole')) ) return false;
			/*
			var lvlnbr;
			if(document.getElementById("chartOfAccounts_classification").innerHTML == "Major code")
			{
			  lvlnbr=1;
			}
			if(document.getElementById("chartOfAccounts_classification").innerHTML == "Minor code")
			{
			 lvlnbr=2;
			}
			if(document.getElementById("chartOfAccounts_classification").innerHTML == "Sub Minor Code")
			{
			  lvlnbr=3;
			}
			if(document.getElementById("chartOfAccounts_classification").innerHTML == "Detail Code")
			{
			  lvlnbr=4;
			}*/
			var mode ="";
			var glId = document.chartOfAccountsEnquiry.glid.value;
			if (glId=="true")
			{
				mode = "modifyPosting";
				//alert('GLcode Posted to General Ledger');
			}
			else
			{
				mode = "modifyAll";
			}


			if(PageValidator.validateForm()){
				var cCode = document.getElementById('chartOfAccounts_glCode').value;
				window.location = "ChartOfAccounts.htm?accCode="+cCode+"&mode="+mode+"&actionId="+document.getElementById("actionId").value;
			}
		}

		function onClickNew(){

			document.getElementById('egUser_id').value = CookieManager.getCookie('currentUserId');
			//   ***1 only FO***,  ***2 FO***,  ***Admin, 3 All***    //
			if(!isValidUser(1, CookieManager.getCookie('userRole')) ) return false;
			var lvlnbr;
			if(document.getElementById("chartOfAccounts_classification").innerHTML == "Major code")
			{
			  lvlnbr=1;
			}
			if(document.getElementById("chartOfAccounts_classification").innerHTML == "Minor code")
			{
			 lvlnbr=2;
			}
			if(document.getElementById("chartOfAccounts_classification").innerHTML == "Sub Minor Code")
			{
			  lvlnbr=3;
			}
			if(document.getElementById("chartOfAccounts_classification").innerHTML == "Detail Code")
			{
			  lvlnbr=4;
			}
			if (lvlnbr < 4 || document.getElementById("chartOfAccounts_classification").innerHTML == "")
			{
				var cCode = document.getElementById('chartOfAccounts_glCode').value;
				window.location = "ChartOfAccounts.htm?accCode="+cCode+"&mode=insert&actionId="+document.getElementById("actionId").value;

			}
			else
			{
				alert('Cannot add code at this level');
			}
		}
		function afterRefreshPage(dc){
			var active = document.getElementById('isActiveForPosting').value;
			if(active == "1")
			 document.getElementById('coa_isActiveForPosting').innerHTML="Yes";
			 else
			document.getElementById('coa_isActiveForPosting').innerHTML="No";
			if(dc.values['chartOfAccounts_classification'])
			{
				if(dc.values['chartOfAccounts_classification'] == 1)
				 {
				  document.getElementById("chartOfAccounts_classification").innerHTML="Major code";
				 }
				 if(dc.values['chartOfAccounts_classification'] == 2)
				 {
				  document.getElementById("chartOfAccounts_classification").innerHTML="Minor code";
				 }
				 if(dc.values['chartOfAccounts_classification'] == 3)
				 {
				  document.getElementById("chartOfAccounts_classification").innerHTML="Sub Minor Code";
				 }
				 if(dc.values['chartOfAccounts_classification'] == 4)
				 {
				   document.getElementById("chartOfAccounts_classification").innerHTML="Detail Code";
				 }
			}

		}
		function beforeRefreshPage(dc)
		{

			if(dc.grids['ifPostedtoGL'])
			document.getElementById("glid").value="true"

		}
		function onClickClose()
		{
			window.close();
			//window.location = "Home.htm";
		}
		</SCRIPT>
	</head>
	<body bgcolor="#ffffff" onKeyDown ="CloseWindow(event);"  bottommargin="0" topmargin="0" rightmargin="0" leftmargin="0" marginheight="0" marginwidth="0" onload="getData();"><!------------------ Header Begins Begins--------------------->

		<form name = "chartOfAccountsEnquiry">

			<input type = "hidden"       name = "glid" id = "glid" >
			<input type="hidden" name="egUser_id" id="egUser_id">
			<input type="hidden" name="isActiveForPosting" id="isActiveForPosting">
			<input type="hidden" name="actionId" id="actionId">
			<table width="100%" border="0" cellpadding="0" cellspacing="0">
				<tr>
					<td valign="top" class="normaltext"><!------------Content begins here ------------------>
						<table width="100%" border="0" cellpadding="3" cellspacing="0">
							<TBODY>
	
				<tr>
					<td ><div align="right" valign="center" class="" width="822"> &nbsp;</div>
					</td>


				</tr>
			</table>
				<table width = "100%" border = 0 cellpadding = "6" cellspacing = "0">
					<tr>
						<td valign = "top"><!------------Content begins here ------------------>
							<table width = "100%" border = 0 cellpadding = "3" cellspacing = "0">

									<td width = "15%" ><div align = "right" valign="middle"     class = "labelcell">Group</div></td>
									<td width = "35%" ><div name  = "chartOfAccounts_group"     class = "displayData" id="chartOfAccounts_group"></div></td>
  									<td width = "25%" ><div align = "right"  valign="middle"    class = "labelcell">Parent Account</div></td>
									<td width = "25%" ><div name  = "chartOfAccounts_majorHead" class = "displayData" id="chartOfAccounts_majorHead" size="10" maxlength="10" exilMustEnter="true">&nbsp;</div></td>
								</tr>
								<tr>
								<td align = "right" valign = "center" class="labelcell" colspan=2>&nbsp;</td></tr>
								<tr >
			    					<td ><div align  = "right" valign="middle"  class = "labelcell">Account Code </div></td>
									<td ><span class="smallfieldcell"><input name = "chartOfAccounts_glCode" class = "fieldinput" id = "chartOfAccounts_glCode" size = "10"  exilMustEnter = "true" exilDataType="exilAlphaNumeric"></span>
										 <IMG onclick = openSearch(this); height = 22 src="../images/plus1.gif" width=25 align=top border=0>&nbsp;<input type=button value="Go" class="leadon" onClick="onClickGo();"></td>
								    <td ><div  align = "right" valign="middle" class = "labelcell">Name</div></td>
									<td ><div   name = "chartOfAccounts_name"  class = "displayData" id = "chartOfAccounts_name" size="10" >&nbsp;</div></td>
								</tr>
								<tr>
								<td align = "right" valign = "center" class="labelcell" colspan=2>&nbsp;</td></tr>
								<tr >
									<td class = "labelcell"><div align = "right">Description</div></td>
									<td><div name = "chartOfAccounts_description" class = "displayData" id = "chartOfAccounts_description"></div></td>
				 				     <td class = "labelcell"><div align = "right">Alternate Name</div></td>
									<td><div name = "chartOfAccounts_alternateName" class = "displayData" id = "chartOfAccounts_alternateName"></div></td>

				 				     <!---<td align = "right" valign = "center" class="labelcell" colspan=2>&nbsp;</td>--->
								</tr>
								<tr>
								<td align = "right" valign = "center" class="labelcell" colspan=2>&nbsp;</td></tr>
								<tr >
									<td class = "labelcell"><div align = "right">Type</div></td>
									<td><div name = "chartOfAccounts_type" class = "displayData" id = "chartOfAccounts_type"></div></td>
				 				     <td class = "labelcell"><div align = "right">Classification</div></td>
									<td><div name = "chartOfAccounts_classification" class = "displayData" id = "chartOfAccounts_classification"></div></td>


								</tr>

								<tr>
								<td align = "right" valign = "center" class="labelcell" colspan=2>&nbsp;</td></tr>

								<tr >
									<td class = "labelcell"><div align = "right">Purpose</div></td>
									<td><div name = "purposeName" class = "displayData" id = "purposeName"></div>
									<input type="hidden" name="chartOfAccounts_purpose" id="chartOfAccounts_purpose"></td>
				 				     <td class = "labelcell"><div align = "right">Account Detail Type</div></td>
									<td><div name = "chartOfAccounts_accType" class = "displayData" id = "chartOfAccounts_accType"></div></td>

				 				 </tr>
				 				 <tr>
								<td align = "right" valign = "center" class="labelcell" colspan=2>&nbsp;</td></tr>
								<tr >
									<td class = "labelcell"><div align = "right">Function Reqd</div></td>
									<td><div name = "chartOfAccounts_funcReqd" class = "displayData" id = "chartOfAccounts_funcReqd"></div></td>
				 				     <td class = "labelcell"><div align = "right">Active For Posting</div></td>
									<td><div name = "coa_isActiveForPosting" class = "displayData" id = "coa_isActiveForPosting"></div></td>
		 				     </tr>
		 				     <tr>
								<td align = "right" valign = "center" class="labelcell" colspan=2>&nbsp;</td></tr>
								<tr >
								<td class = "labelcell"><div align = "right">Budget Check Reqd</div></td>
								<td>
								<div name = "budgetCheckReqd" class = "displayData" id = "budgetCheckReqd" style="width: 0px; height: 0px"></div></td>
								<td class = "labelcell">&nbsp;</td>
								<td><div name = "coa_isActiveForPosting" class = "displayData" id = "coa_isActiveForPosting"></div></td>
							</tr>


								<tr  >
						        	<td  colspan = 4>&nbsp;</td>
						        </tr>
							</table>
							<table width = "100%"  border = "0" cellpadding = "0" cellspacing = "0">
	    						<tr><td></td></tr>
								<tr >
									<td colspan = "4" align = "middle"><!-- Buttons Start Here -->
									<table border="0" cellpadding="0" cellspacing="0"  align="center">
									 <tr >
									 <td>
									 <input   type="button" class="button" value="Add" onclick="onClickNew();" />
									 <input   type="button" class="button" value="Modify" onclick="onClickModify()" />
									 <input   type="button" class="button" value="Close" onclick=onClickClose(); />
									 </td>
									 </tr>
									</table>
									</td>
								</tr>
								</table><!---------- Content ends here ------------------>
							</td>
						</tr>
			   		</table></TD><!------------Right Navigation Ends here------------------></TR></TABLE><!---------------- Footer begins here ----------><!---------------- Footer ends here ---------->
		</form>

	</body>
</html>
